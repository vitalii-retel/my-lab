"use strict";(self.webpackChunklab=self.webpackChunklab||[]).push([[821],{821:(v,w,l)=>{l.r(w),l.d(w,{TickDrawComponent:()=>y});var e=l(946),f=l(814);class b{}class g{constructor(t,i,s,o){this.canvasEl=t,this.metersX=i,this.metersY=s,this.ticksInSecond=o,this.objs=[],this.objPositions=new WeakMap,this.objNextPositions=new WeakMap,this.drawTimeoutId=null,this.tickTimeoutId=null,this.theme={bgColor:"#ffffff",color:"#000000"}}setTheme(t){this.theme=t}addObject(t,{x:i,y:s}){this.objs.push(t),this.objPositions.set(t,{x:i,y:s})}tick(){this.objs.forEach(t=>{const i=t.calculateNextPosition({getObjPosition:r.bind(null,this.objPositions),ticksInSecond:this.ticksInSecond,stop:this.stop.bind(this)});this.objNextPositions.set(t,i)}),this.objs.forEach(t=>{this.objPositions.set(t,r(this.objNextPositions,t))})}start(){this.requestDraw(),this.tickTimeoutId=window.setInterval(()=>this.tick(),1e3/this.ticksInSecond)}stop(){this.drawTimeoutId&&(window.clearTimeout(this.drawTimeoutId),this.drawTimeoutId=null),this.tickTimeoutId&&(window.clearInterval(this.tickTimeoutId),this.tickTimeoutId=null)}requestDraw(){this.drawTimeoutId=window.requestAnimationFrame(()=>this.draw())}draw(){const t=this.canvasEl.getContext("2d");if(!t)throw new Error("Cannot draw!");const i=this.canvasEl.clientWidth,s=this.canvasEl.clientHeight;this.canvasEl.width=i,this.canvasEl.height=s,t.fillStyle=this.theme.bgColor,t.fillRect(0,0,i,s),this.objs.forEach(o=>o.draw({getObjPosition:r.bind(null,this.objPositions),ctx:t,scale:{x:i/this.metersX,y:s/this.metersY},theme:this.theme})),this.requestDraw()}}function r(a,t){const i=a.get(t);if(!i)throw new Error("Could not find position for the object. Check your implementations.");return i}const k=["canvas"];let y=(()=>{class a{constructor(){this.space=null}start(){this.stop(),this.space=new g(this.canvasEl.nativeElement,10,10,100);const i=new h,s=new h,o=new h,n=new h;i.follow(s),s.follow(o),o.follow(n),n.follow(i),this.space.addObject(i,{x:0,y:0}),this.space.addObject(s,{x:10,y:0}),this.space.addObject(o,{x:10,y:10}),this.space.addObject(n,{x:0,y:10}),this.space.setTheme({color:getComputedStyle(this.canvasEl.nativeElement).color,bgColor:getComputedStyle(this.canvasEl.nativeElement).backgroundColor}),this.space.start()}ngOnDestroy(){this.stop()}stop(){this.space&&(this.space.stop(),this.space=null)}}return a.\u0275fac=function(i){return new(i||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["lab-tick-draw"]],viewQuery:function(i,s){if(1&i&&e.Gf(k,5,e.SBq),2&i){let o;e.iGM(o=e.CRH())&&(s.canvasEl=o.first)}},standalone:!0,features:[e.jDz],decls:7,vars:0,consts:[[1,"buttons"],["type","button",3,"click"],["canvas",""]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"button",1),e.NdJ("click",function(){return s.start()}),e._uU(2,"Start"),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return s.stop()}),e._uU(4,"Stop"),e.qZA()(),e._UZ(5,"canvas",null,2))},dependencies:[f.ez],styles:["[_nghost-%COMP%]{display:grid;gap:1em;grid-template-rows:auto 1fr;height:100%}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;gap:1em}[_nghost-%COMP%]   canvas[_ngcontent-%COMP%]{display:block;height:100%;aspect-ratio:1;box-shadow:var(--shadow);background-color:var(--bg-main);color:var(--c-main)}"]}),a})();class h extends b{constructor(){super(...arguments),this.followDog=this,this.l=0}calculateNextPosition({getObjPosition:t,ticksInSecond:i,stop:s}){const o=t(this),n=t(this.followDog),d=1/i,p=Math.sqrt(Math.pow(n.x-o.x,2)+Math.pow(n.y-o.y,2)),m=p/1,u={x:o.x+(n.x-o.x)/m*d,y:o.y+(n.y-o.y)/m*d};return this.l+=Math.sqrt(Math.pow(u.x-o.x,2)+Math.pow(u.y-o.y,2)),console.log(this.l),p<2*d&&s(),u}draw({getObjPosition:t,theme:i,ctx:s,scale:o}){const{x:n,y:c}=t(this);s.beginPath(),s.strokeStyle=i.color,s.lineWidth=1,s.arc(n*o.x,c*o.y,.1*o.x,0,2*Math.PI),s.stroke()}follow(t){this.followDog=t}}}}]);