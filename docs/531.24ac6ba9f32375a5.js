"use strict";(self.webpackChunklab=self.webpackChunklab||[]).push([[531],{9531:(v,p,c)=>{c.r(p),c.d(p,{ObjectThrowingComponent:()=>j});var h=c(6814),r=c(7432);class d{#t={};get items(){return this.#t}constructor(i={}){Object.assign(this.#t,i)}add(i,s){this.#t="function"!=typeof s?{...this.#t,[i]:s}:{...this.#t,[i]:s(this.#t[i])}}}const u="on",l="time";class f{#t=[];#i=new WeakMap;#e=new WeakMap;#p=1e3*this.ticksInterval;#n="stopped";#_=Date.now();#o=Date.now();#a=0;#r;#s={real:Date.now(),space:Date.now()};#c=new d({[u]:!1});#d;#l;get statistic(){return this.#c.items}constructor(i){this.ticksInterval=i}addObject(i,{x:s,y:e}){this.#t.push(i),this.#i.set(i,{x:s,y:e})}setCanvas(i){this.#r=i,this.#h()}start(){this.#n="started",this.#h(),this.#c.add(u,!0),this.#s.real=Date.now(),this.#s.space=this.statistic[l]||0,this.#_=Date.now(),this.#o=this.#_,this.#a=0,this.#g(),this.#f()}stop(){this.#n="stopped",this.#h(),clearTimeout(this.#d),this.#l&&cancelAnimationFrame(this.#l),this.#c.add(u,!1)}#g(){if("stopped"===this.#n)return;const i=25===this.#a?this.#o:Date.now();if(i>this.#o)return this.#a++,void this.#m();this.#a=0,this.#d=setTimeout(()=>this.#m(),this.#o-i)}#m(){if(this.#t.some(s=>s.shouldStop({getObjPosition:e=>this.#i.get(e)})))return void this.stop();this.#t.forEach(s=>{const e=s.calculateNextPosition({getObjPosition:o=>this.#i.get(o),ticksInterval:this.ticksInterval});this.#e.set(s,e)}),this.#t.forEach(s=>{this.#i.set(s,this.#e.get(s))}),this.#c.add(l,s=>(s??0)+this.ticksInterval);const i=Date.now()-this.#s.real;i>1e3&&(this.#c.add("timeSpeed",1e3*(this.statistic[l]-this.#s.space)/i),this.#s.real+=i,this.#s.space=this.statistic[l]),this.#o+=this.#p,this.#g()}#f(){"stopped"!==this.#n&&(this.#l=requestAnimationFrame(()=>this.#T()))}#T(){this.#h(),this.#f()}#h(){if(!this.#r)return;const i=this.#r;i.clean(),this.#t.forEach(s=>s.draw({getObjPosition:e=>this.#i.get(e),cx:e=>e*i.scaleX,cy:e=>(i.sizeY-e)*i.scaleY,cdx:(e,o)=>this.#u(e*i.scaleX,o??0),cdy:(e,o)=>this.#u(-e*i.scaleY,o??0),cd:(e,o)=>this.#u(e*i.scaleX,o??0),ctx:i.ctx,theme:i.theme}))}#u(i,s){return i>=0?Math.max(i,s):Math.min(i,s)}}class T{#t=0;#i=new r.$k;get statistic(){return this.#i.items}shouldStop({getObjPosition:i}){return i(this).y<=0}calculateNextPosition({ticksInterval:i,getObjPosition:s}){this.#t+=9.8*i;const e={x:s(this).x,y:s(this).y-i*this.#t};return this.#i.add("speed",this.#t),this.#i.add("altitude",e.y),e}draw({ctx:i,cx:s,cy:e,cd:o,getObjPosition:a,theme:Z}){const{x:Q,y:S}=a(this);i.beginPath(),i.strokeStyle=Z.color,i.lineWidth=1,i.arc(s(Q),e(S),o(.1,5),0,2*Math.PI),i.stroke()}}var x=c(7398),_=c(4936),t=c(6146);function w(n,i){if(1&n){const s=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){t.CHM(s);const o=t.oxw();return t.KtG(o.start())}),t._uU(1," Start "),t.qZA()}}function b(n,i){if(1&n){const s=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){t.CHM(s);const o=t.oxw();return t.KtG(o.stop())}),t._uU(1," Stop "),t.qZA()}}function y(n,i){if(1&n&&(t.TgZ(0,"ui-statistic-line"),t.ynx(1,7),t._uU(2,"State"),t.BQk(),t.ynx(3,8),t._uU(4),t.BQk(),t.qZA()),2&n){const s=t.oxw().ngIf;t.xp6(4),t.Oqu(s.space.on?"on":"off")}}function C(n,i){if(1&n&&(t.TgZ(0,"ui-statistic-line"),t.ynx(1,7),t._uU(2,"Time"),t.BQk(),t.ynx(3,8),t._uU(4),t.ALo(5,"number"),t.BQk(),t.qZA()),2&n){const s=t.oxw().ngIf;t.xp6(4),t.hij("",t.xi3(5,1,s.space.time,"1.3-3")," s")}}function k(n,i){if(1&n&&(t.TgZ(0,"ui-statistic-line"),t.ynx(1,7),t._uU(2,"Time speed"),t.BQk(),t.ynx(3,8),t._uU(4),t.ALo(5,"number"),t.BQk(),t.qZA()),2&n){const s=t.oxw().ngIf;let e;t.xp6(4),t.hij(" ",t.xi3(5,1,100*(null!==(e=s.space.timeSpeed)&&void 0!==e?e:0),"1.1-1")," % ")}}function O(n,i){if(1&n&&(t.TgZ(0,"ui-statistic-line"),t.ynx(1,7),t._uU(2,"Speed"),t.BQk(),t.ynx(3,8),t._uU(4),t.ALo(5,"number"),t.BQk(),t.qZA()),2&n){const s=t.oxw().ngIf;t.xp6(4),t.hij(" ",t.xi3(5,1,s.ball.speed,"1.2-2")," m/s ")}}function I(n,i){if(1&n&&(t.TgZ(0,"ui-statistic-line"),t.ynx(1,7),t._uU(2,"Altitude"),t.BQk(),t.ynx(3,8),t._uU(4),t.ALo(5,"number"),t.BQk(),t.qZA()),2&n){const s=t.oxw().ngIf;t.xp6(4),t.hij(" ",t.xi3(5,1,s.ball.altitude,"1.1-1")," m ")}}function A(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"ui-statistic"),t.ynx(2,6),t._uU(3,"Space"),t.BQk(),t.YNc(4,y,5,1,"ui-statistic-line",4)(5,C,6,4,"ui-statistic-line",4)(6,k,6,4,"ui-statistic-line",4),t.qZA(),t.TgZ(7,"ui-statistic"),t.ynx(8,6),t._uU(9,"Ball"),t.BQk(),t.YNc(10,O,6,4,"ui-statistic-line",4)(11,I,6,4,"ui-statistic-line",4),t.qZA(),t.BQk()),2&n){const s=i.ngIf;t.xp6(4),t.Q6J("ngIf",s.space.hasOwnProperty("on")),t.xp6(1),t.Q6J("ngIf",s.space.hasOwnProperty("time")),t.xp6(1),t.Q6J("ngIf",s.space.hasOwnProperty("timeSpeed")),t.xp6(4),t.Q6J("ngIf",s.ball.hasOwnProperty("speed")),t.xp6(1),t.Q6J("ngIf",s.ball.hasOwnProperty("altitude"))}}let j=(()=>{class n{#t;#i;constructor(s){this.cdr=s,this.statistic$=(0,r.WI)(()=>({space:this.#t?.statistic??{},ball:this.#i?.statistic??{}})),this.started$=this.statistic$.pipe((0,x.U)(e=>e.space.on))}reset(){this.#e(),this.#t=new f(.005),this.#i=new T,this.#t.addObject(this.#i,{x:100,y:1500}),this.#t.setCanvas(this.canvasComponent)}start(){this.#t?.start()}stop(){this.#t?.stop()}ngAfterViewInit(){this.reset(),this.cdr.detectChanges()}ngOnDestroy(){this.#e()}#e(){this.stop(),this.#t=void 0,this.#i=void 0}static#p=this.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO))};static#n=this.\u0275cmp=t.Xpm({type:n,selectors:[["lab-object-throwing"]],viewQuery:function(e,o){if(1&e&&t.Gf(r.cY,5),2&e){let a;t.iGM(a=t.CRH())&&(o.canvasComponent=a.first)}},standalone:!0,features:[t.jDz],decls:11,vars:11,consts:[[1,"control-panel"],[1,"buttons"],["type","button",3,"click"],["type","button",3,"click",4,"ngIf"],[4,"ngIf"],[3,"sizeX","sizeY"],["title",""],["label",""],["value",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return o.reset()}),t._uU(3,"Reset"),t.qZA(),t.YNc(4,w,2,0,"button",3),t.ALo(5,"async"),t.YNc(6,b,2,0,"button",3),t.ALo(7,"async"),t.qZA(),t.YNc(8,A,12,5,"ng-container",4),t.ALo(9,"async"),t.qZA(),t._UZ(10,"tick-canvas",5)),2&e&&(t.xp6(4),t.Q6J("ngIf",!t.lcZ(5,5,o.started$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,7,o.started$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(9,9,o.statistic$)),t.xp6(2),t.Q6J("sizeX",2e3)("sizeY",1500))},dependencies:[h.ez,h.O5,h.Ov,h.JJ,r.cY,_._E,_.Dd],styles:["[_nghost-%COMP%]{display:grid;grid-template-columns:auto 1fr;gap:1em;height:100%}[_nghost-%COMP%]   .control-panel[_ngcontent-%COMP%]{display:grid;gap:1em;align-content:start}[_nghost-%COMP%]   .control-panel[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;gap:.5em}"],changeDetection:0})}return n})()}}]);